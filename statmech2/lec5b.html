<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta name="generator" content="jemdoc, see http://jemdoc.jaboc.net/" />
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link rel="stylesheet" href="jemdoc.css" type="text/css" />
<title>The Variational Principle</title>
</head>
<body>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
    var pageTracker = _gat._getTracker("UA-131436916-1");
    pageTracker._trackPageview();
} catch(err) {}</script>
<table summary="Table for page layout." id="tlayout">
<tr valign="top">
<td id="layout-menu">
<div class="menu-category">Stat Mech II</div>
<div class="menu-item"><a href="index.html">Home</a></div>
<div class="menu-item"><a href="contents.html">Table&nbsp;of&nbsp;Contents</a></div>
<div class="menu-category">First Lecture</div>
<div class="menu-item"><a href="intro.html">Overview</a></div>
<div class="menu-item"><a href="intro2.html">Phase&nbsp;Transitions</a></div>
<div class="menu-item"><a href="intro3.html">Symmetry</a></div>
<div class="menu-item"><a href="intro4.html">Ising&nbsp;Model&nbsp;Def'n</a></div>
<div class="menu-item"><a href="intro5.html">Ising&nbsp;Thermo</a></div>
<div class="menu-category">1D Ising Model</div>
<div class="menu-item"><a href="lec2.html">Motivation</a></div>
<div class="menu-item"><a href="lec3.html">The&nbsp;Big&nbsp;Picture</a></div>
<div class="menu-item"><a href="lec4.html">Exact&nbsp;Solution</a></div>
<div class="menu-category">Mean Field Theory</div>
<div class="menu-item"><a href="lec5a.html">Overview</a></div>
<div class="menu-item"><a href="lec5b.html" class="current">Variational&nbsp;Principle</a></div>
<div class="menu-item"><a href="lec5c.html">Non-interacting&nbsp;Spins</a></div>
<div class="menu-item"><a href="lec5d.html">Mean-Field&nbsp;Ising&nbsp;Sol'n</a></div>
<div class="menu-item"><a href="lec5e.html">Summary&nbsp;+&nbsp;Interp'n</a></div>
<div class="menu-category">Landau-Ginzburg</div>
<div class="menu-item"><a href="week4a.html">Overview&nbsp;and&nbsp;Outline</a></div>
<div class="menu-item"><a href="week4c.html">Probe&nbsp;Fields</a></div>
<div class="menu-item"><a href="week4d.html">What&nbsp;is&nbsp;Free&nbsp;Energy?</a></div>
<div class="menu-item"><a href="week4e.html">Landau&nbsp;Theory</a></div>
<div class="menu-item"><a href="week4f.html">Order&nbsp;Param&nbsp;Fields</a></div>
<div class="menu-item"><a href="week4g.html">Symmetry&nbsp;Arguments</a></div>
<div class="menu-item"><a href="week4h.html">Spatial&nbsp;Textures</a></div>
<div class="menu-item"><a href="week4i.html">Gaussian&nbsp;Model</a></div>
<div class="menu-item"><a href="fun.html">Applets!</a></div>
<div class="menu-category">Transport</div>
<div class="menu-item"><a href="week8a.html">Kinetic&nbsp;Theory</a></div>
<div class="menu-item"><a href="week8b.html">Diffusion&nbsp;and&nbsp;Viscosity</a></div>
<div class="menu-item"><a href="week8c.html">Boltzmann&nbsp;Equation</a></div>
</td>
<td id="layout-content">
<div id="toptitle">
<h1>The Variational Principle</h1>
</div>
<p>When Prof. Kivelson walked into class today, he looked a bit taken by surprise. He just kind of stood there for a bit and stared at everyone who stared back at him. There was a funny look on his face, like, &lsquo;&lsquo;Oh, you're expecting me to teach you something?&rsquo;&rsquo; Well, yes, we would like you to teach us some statistical mechanics!</p>
<p>In class, we spent <i>way</i> too much time proving the variational principle, and not enough time explaining what it actually means. Honestly, it's much more important to understand the logic behind a variational argument than to know how to prove it&hellip;so of all the sections on this page, the <a href="#motivation">Motivation and Overview</a> section is most important. (I don't even know if I'll get around to writing the rest of the sections&hellip;I have a life too, you know!)</p>
<h3>Outline</h3>
<ul>
<li><p><a href="#motivation">Motivation and Overview</a></p>
</li>
<li><p><a href="#jenson">Jenson's Inequality</a></p>
</li>
<li><p><a href="#variational">Proving the Variational Principle</a></p>
</li>
<li><p><a href="#quantum">Connection to Quantum Mechanics and trial wavefunctions</a></p>
</li>
<li><p><a href="#discussion">Discussion: does &lsquo;&lsquo;best&rsquo;&rsquo; mean &lsquo;&lsquo;good enough&rsquo;&rsquo;?</a></p>
</li>
</ul>
<p><a name="motivation"></a></p>
<h2>Motivation and Summary</h2>
<p>One of the key points today is that interacting systems are <i>very difficult</i> to solve in general. The variational principle is a useful tool to have in our pocket because it lets us leverage the Hamiltonians which we actually <i>can</i> solve to solve Hamiltonians which we <i>can't</i>.</p>
<div class="infoblock">
<div class="blocktitle">Key Point</div>
<div class="blockcontent">
<p>The strategy of the variational principle is to use a problem we <i>can</i> solve to <b>approximate</b> a problem we <i>can't</i>.</p>
<p>More preciesly, suppose we want to solve a hard system with a Hamiltonian <img class="eq" src="eqs/9216027721-130.png" alt="H" style="vertical-align: -0px" />. Our plan of attack is to approximate it with a different &lsquo;&lsquo;trial Hamiltonian&rsquo;&rsquo; <img class="eq" src="eqs/3679062891044675811-130.png" alt="H_{tr}" style="vertical-align: -4px" /> which has the same general &lsquo;&lsquo;flavor&rsquo;&rsquo; as the actual Hamiltonian, but (in contrast) is <i>actually solvable</i>. You could also call <img class="eq" src="eqs/3679062891044675811-130.png" alt="H_{tr}" style="vertical-align: -4px" /> a different name such as a &lsquo;&lsquo;variational ansatz&rsquo;&rsquo; or a &lsquo;&lsquo;guess of the solution shape&rsquo;&rsquo; or even &lsquo;&lsquo;a random shot in the dark.&rsquo;&rsquo; The main point is that the the trial Hamiltonian should be a solvable problem that's similar to the actual problem at hand.</p>
<p>But we don't care about the trial Hamiltonian &ndash; we care about the actual hamiltornian <img class="eq" src="eqs/9216027721-130.png" alt="H" style="vertical-align: -0px" />. So a natural question to ask is, &lsquo;&lsquo;what's our best guess for the free energy of the actual system&rsquo;&rsquo;?</p>
<p>The variational principle tells us that:</p>
<p>1. Our best guess for the actual free energy is given by the <b>variational free energy</b> <img class="eq" src="eqs/8823798170818714545-130.png" alt="F_{var}" style="vertical-align: -4px" />, which you can find by adding a little correction to the trial Hamiltonian's free energy <img class="eq" src="eqs/3622808163388452813-130.png" alt="F_{tr}" style="vertical-align: -4px" />:</p>

<div class="eqwl"><img class="eqwl" src="eqs/7058864638812402729-130.png" alt=" F_{var} = F_{tr} + langle H - H_{tr} rangle_{tr}. " />
<br /></div><p>2. No matter how good a guess your variational free energy <img class="eq" src="eqs/8823798170818714545-130.png" alt="F_{var}" style="vertical-align: -4px" /> is, it will <i>always</i> be greater than or equal to the <i>actual</i> free energy <img class="eq" src="eqs/8960026951-130.png" alt="F" style="vertical-align: -0px" />; that is,</p>

<div class="eqwl"><img class="eqwl" src="eqs/3064227166199458528-130.png" alt=" F_{var} geq F. " />
<br /></div><p>3. The <i>best</i> variational solution we can find is the one that gets <i>as close as possible</i> to the actual Hamiltonian.</p>
</div></div>
<p>A quick comment about notation: When we write <img class="eq" src="eqs/7392999805107193996-130.png" alt="langle O rangle_{tr}" style="vertical-align: -5px" /> it means that we're considering the average of some observable O in the trial ensemble; that is, it answers the question &lsquo;&lsquo;what would the average of O be if the system were <i>actually</i> the trial Hamiltonian?&rsquo;&rsquo; Operationally, <img class="eq" src="eqs/7392999805107193996-130.png" alt="langle O rangle_{tr}" style="vertical-align: -5px" /> is calculated using the probability weights of the <i>trial</i> Hamiltonian, by calculating</p>

<div class="eqwl"><img class="eqwl" src="eqs/1637660771266487675-130.png" alt="     langle O rangle_{tr} = frac 1 {Z_{tr}} sum_{textrm{states}} e^{-beta H_{tr}(textrm{state})} O({state}). " />
<br /></div><p>(Notice the subscript &lsquo;&lsquo;tr&rsquo;&rsquo; on the partition function and Hamiltonian here.)</p>
<h3>Minimizing the variational free energy</h3>
<p>The key point of the variational principle is that <b>our best guess is the one with the smallest variational free energy</b> <img class="eq" src="eqs/8823798170818714545-130.png" alt="F_{var}" style="vertical-align: -4px" />. Practically speaking, our strategy is to start with a whole <i>family</i> of possible trial Hamiltonians, and then just pick the one whose variational free energy is the smallest.</p>
<p>For instance, our family of trial Hamiltonians might be <i>all possible 2D Ising models</i></p>

<div class="eqwl"><img class="eqwl" src="eqs/5487534676989741993-130.png" alt="     H(K,b) = -K sum_{langle ij rangle} sigma_i sigma_j - bsum_{j} sigma_j, " />
<br /></div><p>where <i>we can pick</i> the parameters <img class="eq" src="eqs/9600028874-130.png" alt="K" style="vertical-align: -0px" /> and <img class="eq" src="eqs/12544037731-130.png" alt="b" style="vertical-align: -1px" /> that enter into the Hamiltonian. We have a lot of choices; picking <img class="eq" src="eqs/2002344465029860261-130.png" alt="K=10" style="vertical-align: -1px" /> and <img class="eq" src="eqs/1318904168055673560-130.png" alt="b=50" style="vertical-align: -1px" /> gives us one possible trial Hamiltonian; picking <img class="eq" src="eqs/8187900538629405437-130.png" alt="K=0.002" style="vertical-align: -1px" /> and <img class="eq" src="eqs/8702383744514011849-130.png" alt="b=3.14" style="vertical-align: -1px" /> gives us another possibility, etc., and the variational principle tells us that our <i>best</i> guess for <img class="eq" src="eqs/9600028874-130.png" alt="K" style="vertical-align: -0px" /> and <img class="eq" src="eqs/12544037731-130.png" alt="b" style="vertical-align: -1px" /> is the choice that minimizes <img class="eq" src="eqs/8823798170818714545-130.png" alt="F_{var}" style="vertical-align: -4px" />.</p>
<p>In the picture below, I've illustrated my point. There's a whole bunch of different <img class="eq" src="eqs/12544037731-130.png" alt="b" style="vertical-align: -1px" />'s that we can pick, and our best choice is <img class="eq" src="eqs/327024216863240897-130.png" alt="b^*" style="vertical-align: -1px" /> because it minimizes <img class="eq" src="eqs/8823798170818714545-130.png" alt="F_{var}" style="vertical-align: -4px" />.</p>
<p><img src="img/variational.png"></p>
<p>Here I've plotted how <img class="eq" src="eqs/8823798170818714545-130.png" alt="F_{var}" style="vertical-align: -4px" /> depends on the <img class="eq" src="eqs/12544037731-130.png" alt="b" style="vertical-align: -1px" /> parameter in the trial Hamiltonian. (I've left out the <img class="eq" src="eqs/9600028874-130.png" alt="K" style="vertical-align: -0px" /> parameter for simplicity). Notice that no matter <i>what</i> I choose for the <img class="eq" src="eqs/12544037731-130.png" alt="b" style="vertical-align: -1px" /> parameter, the variational free energy <img class="eq" src="eqs/8823798170818714545-130.png" alt="F_{var}" style="vertical-align: -4px" /> is always bigger than the actual free energy <img class="eq" src="eqs/8960026951-130.png" alt="F" style="vertical-align: -0px" />. And my <i>best</i> guess for <img class="eq" src="eqs/12544037731-130.png" alt="b" style="vertical-align: -1px" /> is the one that makes <img class="eq" src="eqs/8823798170818714545-130.png" alt="F_{var}" style="vertical-align: -4px" /> as close to <img class="eq" src="eqs/8960026951-130.png" alt="F" style="vertical-align: -0px" /> possible.</p>
<p>Okay I think I've nailed the point into the floor enough by now. Operationally, here are the steps to apply the variational principle:</p>
<div class="infoblock">
<div class="blocktitle">Steps</div>
<div class="blockcontent">
<ol>
<li><p>First, solve the thermodynamics of the trial Hamiltonian <img class="eq" src="eqs/3679062891044675811-130.png" alt="H_{tr}" style="vertical-align: -4px" /> by finding <img class="eq" src="eqs/4744834716236931353-130.png" alt="Z_{tr}" style="vertical-align: -4px" />, <img class="eq" src="eqs/3622808163388452813-130.png" alt="F_{tr}" style="vertical-align: -4px" />, <img class="eq" src="eqs/1600176484689100066-130.png" alt="langle ldots rangle_{tr}" style="vertical-align: -5px" />, and whatever else you need.</p>
</li>
<li><p>Next, calculate the variational free energy <img class="eq" src="eqs/985149235001100686-130.png" alt="F_{var} = F_{tr} + langle H - H_{tr} rangle_{tr}" style="vertical-align: -5px" />.</p>
</li>
<li><p>Finally, minimize the variational free energy by setting its derivative w.r.t. the variational parameters equal to zero. So if our trial Hamiltonian <img class="eq" src="eqs/6579114197708817326-130.png" alt="H_{tr}(b_j)" style="vertical-align: -6px" /> depends on parameters <img class="eq" src="eqs/327024216864240962-130.png" alt="b_j" style="vertical-align: -6px" />, then we should set <img class="eq" src="eqs/3215186864000419515-130.png" alt="frac {partial F_{var}} {partial b_j} = 0" style="vertical-align: -10px" /> and then solve for the parameters <img class="eq" src="eqs/327024216864240962-130.png" alt="b_j" style="vertical-align: -6px" />.</p>
</li>
</ol>
</div></div>
<p>Hooray, we've learned the variational principle. I'm not sure if I'll get around to finishing up the rest of this page&hellip;for now just go on to the <a href="lec5c.html">next page about non-interacting spins</a>.</p>
<p><a name="jenson"></a></p>
<h2>Jenson's Inequality</h2>
<p><a name="variational"></a></p>
<h2>Proving the Variational Principle</h2>
<p><a name="quantum"></a></p>
<h2>Connection to Quantum Mechanics&rsquo; Variational Principle</h2>
<p><a name="discussion"></a></p>
<h2>Discussion</h2>
<hr>
<h2>Leave a Comment Below!</h2>
<!-- begin wwww.htmlcommentbox.com -->
 <div id="HCB_comment_box"><a href="http://www.htmlcommentbox.com">Comment Box</a> is loading comments...</div>
 <link rel="stylesheet" type="text/css" href="//www.htmlcommentbox.com/static/skins/simple/skin.css" />
<script> hcb_user = { PAGE: window.location.href.replace("jeffjar.me", "stanford.edu/~jeffjar") }; </script>
 <script type="text/javascript" id="hcb"> /*<!--*/ if(!window.hcb_user){hcb_user={};} (function(){var s=document.createElement("script"), l=hcb_user.PAGE || (""+window.location).replace(/'/g,"%27"), h="//www.htmlcommentbox.com";s.setAttribute("type","text/javascript");s.setAttribute("src", h+"/jread?page="+encodeURIComponent(l).replace("+","%2B")+"&mod=%241%24wq1rdBcg%24SzKUHmoBrUkWOX04Bdn9J1"+"&opts=16862&num=10&ts=1548746886421");if (typeof s!="undefined") document.getElementsByTagName("head")[0].appendChild(s);})(); /*-->*/ </script>
<!-- end www.htmlcommentbox.com -->
<div id="footer">
<div id="footer-text">
Page generated 2020-06-24 20:34:16 PDT, by <a href="http://jemdoc.jaboc.net/">jemdoc</a>.
(<a href="lec5b.jemdoc">source</a>)
</div>
</div>
</td>
</tr>
</table>
</body>
</html>
